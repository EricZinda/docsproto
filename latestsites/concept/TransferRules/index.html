<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>DELPH-IN Concepts</title>
<meta name="description" content="An amazing website.">


  <meta name="author" content="Your Name">
  


<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="DELPH-IN Concepts">
<meta property="og:title" content="DELPH-IN Concepts">
<meta property="og:url" content="http://blog.inductorsoftware.com/docsproto/concept/TransferRules/">


  <meta property="og:description" content="An amazing website.">











  

  


<link rel="canonical" href="http://blog.inductorsoftware.com/docsproto/concept/TransferRules/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Your Name",
      "url": "http://blog.inductorsoftware.com/docsproto/concept/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/docsproto/concept/feed.xml" type="application/atom+xml" rel="alternate" title="DELPH-IN Concepts Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/docsproto/concept/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--delphin_page wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/docsproto/concept/"><img src="/docsproto/concept/assets/images/Delph-In.png" alt="DELPH-IN Concepts"></a>
        
        <a class="site-title" href="/docsproto/concept/">
          DELPH-IN Concepts
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/home/Home">Home</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/concept/TreebankingTop">Concepts</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/tools/ToolsTop">Tools</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/erg/ErgTop">ERG</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/grammars/GrammarCatalogue">Grammars</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/matrix/MatrixTop">Matrix</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/summits/SummitTop">Summits</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">Treebanking</span>
        

        
        <ul>
          
            <li><a href="/docsproto/concept/TreebankingTop">Overview</a></li>
          
            <li><a href="/docsproto/concept/FftbTop">Full Forest Treebanker (FFTB)</a></li>
          
            <li><a href="/docsproto/concept/FftbWishlist">Full Forest Treebanker Wishlist</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking">[incr tsdb()] Treebanking</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking_ItsdbAnnotation">[incr tsdb()] Treebanking Annotation</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking_ItsdbUpdating">[incr tsdb()] Treebanking Updating</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking_ItsdbExporting">[incr tsdb()] Treebanking Exporting</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking_ItsdbModeling">[incr tsdb()] Treebanking Modeling</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking_ItsdbUpdating">[incr tsdb()] Treebanking Updating</a></li>
          
            <li><a href="/docsproto/concept/ItsdbCustomization">[incr tsdb()] Treebanking Customization</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking_ItsdbModeling">[incr tsdb()] Treebanking Modeling</a></li>
          
            <li><a href="/docsproto/concept/IndraTreebanking">Indra</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Formats</span>
        

        
        <ul>
          
            <li><a href="/docsproto/concept/DelphinRFCs">Delphin RFCs</a></li>
          
            <li><a href="/docsproto/concept/PredicateRfc">Predicate RFC</a></li>
          
            <li><a href="/docsproto/concept/MrsRFC">MRS Format RFC</a></li>
          
            <li><a href="/docsproto/concept/MrsIsomorphism">MRS Isomorphism</a></li>
          
            <li><a href="/docsproto/concept/EdsTop">EDS Format</a></li>
          
            <li><a href="/docsproto/concept/EdsConversion">EDS Conversion</a></li>
          
            <li><a href="/docsproto/concept/EdsGeneration">EDS Generation</a></li>
          
            <li><a href="/docsproto/concept/SemiRfc">SEM-I RFC</a></li>
          
            <li><a href="/docsproto/concept/TdlRFC">TDL RFC</a></li>
          
            <li><a href="/docsproto/concept/TsqlRfc">TSQL RFC</a></li>
          
            <li><a href="/docsproto/concept/GrammarVersionRfc">Grammar Version RFC</a></li>
          
            <li><a href="/docsproto/concept/GrammarConfigurationRfc">Grammar Configuration RFC</a></li>
          
            <li><a href="/docsproto/concept/TsdbSchemaRfc">TSDB Schema RFC</a></li>
          
            <li><a href="/docsproto/concept/MatrixChoicesRfc">Matrix Choices RFC</a></li>
          
            <li><a href="/docsproto/concept/RmrsTop">(R)MRS Overview</a></li>
          
            <li><a href="/docsproto/concept/RmrsWellformedness">(R)MRS Wellformedness</a></li>
          
            <li><a href="/docsproto/concept/RmrsPos">(R)MRS Predicate Naming</a></li>
          
            <li><a href="/docsproto/concept/RmrsSpan">(R)MRS Span</a></li>
          
            <li><a href="/docsproto/concept/RmrsDesign">(R)MRS Design</a></li>
          
            <li><a href="/docsproto/concept/RmrsParaphrasing">(R)MRS Paraphrasing</a></li>
          
            <li><a href="/docsproto/concept/RmrsModel">(R)MRS Model</a></li>
          
            <li><a href="/docsproto/concept/RmrsDistributional">(R)MRS Distributional</a></li>
          
            <li><a href="/docsproto/concept/RmrsSemi">(R)MRS Semi</a></li>
          
            <li><a href="/docsproto/concept/RmrsDmrs">(R)MRS Dmrs</a></li>
          
            <li><a href="/docsproto/concept/RmrsFaq">(R)MRS Faq</a></li>
          
            <li><a href="/docsproto/concept/RmrsDiscussions">(R)MRS Discussions</a></li>
          
            <li><a href="/docsproto/concept/TransferRules">Transfer Rules</a></li>
          
            <li><a href="/docsproto/concept/FormatSpecifications">Format Specifications</a></li>
          
            <li><a href="/docsproto/concept/ErgGml">Grammar Markup Language</a></li>
          
            <li><a href="/docsproto/concept/SmafTop">SMAF</a></li>
          
            <li><a href="/docsproto/concept/IconsSpecs">Icons Specs</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Discussions</span>
        

        
        <ul>
          
            <li><a href="/docsproto/concept/SaarlandSententialArgument">Saarland Sentential Argument</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Housekeeping</span>
        

        
        <ul>
          
            <li><a href="/docsproto/concept/ErgSemantics_Raw_Materials">Raw Materials</a></li>
          
            <li><a href="/docsproto/concept/ErgSemantics_Conventions">ERG Semantics Conventions</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
        <p>This page describes the transfer rule formalism used for, among other
things, [wiki:<a href="MachineTranslationTop">MachineTranslationTop</a> MT],
[wiki:<a href="../RmrsParaphrasing">RmrsParaphrasing</a> paraphrasing] and
[wiki:<a href="https://blog.inductorsoftware.com/docsproto/grammars/JacyGeneration">JacyGeneration</a> generation].</p>

<p><a href="/TableOfContents">TableOfContents</a></p>

<h1 id="basic-structure">Basic Structure</h1>

<p>A transfer rule is a quadruple &lt;F, C, I, O&gt;, where each element is
a partial MRS, with:</p>

<ul>
  <li>- F: an input filter; when F matches against the input MRS, the
rule is
    <ul>
      <li>blocked; F is evaluated <strong>after</strong> C and I have matched;</li>
    </ul>

    <p>- C: the input context; needs to match for a rule to apply and
binds</p>
    <ul>
      <li>variables, but is preserved in the output;</li>
    </ul>

    <p>- I: the input description; matches against the input MRS;
everything that</p>
    <ul>
      <li>was matched in the input will be replaced by the OUTPUT part;</li>
    </ul>

    <p>- O: the output description; everything in the OUTPUT part is
inserted</p>
    <ul>
      <li>into the MRS, respecting variable bindings that have been
established in matching earlier components.</li>
    </ul>
  </li>
</ul>

<p>There is also a mysterious fifth element FLAGS, which has several
subtypes (OPTIONAL, EQUAL, SUBSUME, BLOCK).</p>

<ul>
  <li>- EQUAL: takes a list of identifiers and forces an equality
comparison instead of a subsumption
    <ul>
      <li>test wherever they appear in the rule.</li>
    </ul>

    <p>- OPTIONAL: has value of + or - and makes application of the rule
optional. if the rule matches,</p>
    <ul>
      <li>the MT system will fork creating an instance where the rule
applied and another where it didn’t.</li>
    </ul>

    <p>- BLOCK: takes a documentation string. A rule marked with
FLAGS.BLOCK will prune that path from the</p>
    <ul>
      <li>transfer process.</li>
    </ul>
  </li>
</ul>

<p>An example transfer rule (from <a href="/JaEn">JaEn</a>):</p>

<p>This takes an input ep with a predicate of “_inu_n_rel” (犬) and
transfers it to one with a predicate of “_dog_n_1_rel” (<em>dog</em>),
preserving the values of the LBL and ARG0.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>inu_n := noun_mtr &amp;
[ INPUT.RELS &lt; [ PRED "_inu_n_rel" ] &gt;,
  OUTPUT.RELS &lt; [ PRED "_dog_n_1_rel" ] &gt; ].
</code></pre></div></div>

<p>which is a subtype of:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>noun_mtr := monotonic_mtr &amp;
[ INPUT.RELS &lt; [ LBL #h1, ARG0 #x1 ] &gt;,
  OUTPUT.RELS &lt; [ LBL #h1, ARG0 #x1 ] &gt; ].
</code></pre></div></div>

<h2 id="regular-expressions">Regular Expressions</h2>

<p>You can use regular expressions in predicate names, by starting them
with a tilde <strong>~</strong>. They cannot be used with variables. Regular
expressions are commonly used in the CONTEXT element, both for transfer
and generation.</p>

<p>Here is an example of a pair of rules to switch the arguments of
prepositions. The first rule identifies prepositions using a regular
expression ~_p_ and marks them with a special predicate. The second
rule removes the special predicate, and reverses the arguments.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>prep_mark_jf := monotonic_mtr &amp;
[ CONTEXT.RELS &lt; [ PRED "~_p_", LBL #h0, ARG0 #e1 &amp; e ] &gt;,
  FILTER.RELS &lt; [ PRED "prep_swap_mark", LBL #h0, ARG0 #e1 ] &gt;,
  OUTPUT.RELS &lt; [ PRED "prep_swap_mark", LBL #h0, ARG0 #e1 ] &gt;,
  FLAGS.EQUAL &lt; #e1 &gt; ].

prep_swap_jf := monotonic_mtr &amp;
[ INPUT.RELS &lt; [ LBL #h1, PRED #pred, 
                 ARG0 #e1, ARG1 #1, ARG2 #2 ],
               [ PRED "prep_swap_mark", LBL #h1, ARG0 #e1 ] &gt;,
  OUTPUT.RELS &lt; [ LBL #h1, PRED #pred, 
                  ARG0 #e1, ARG1 #2, ARG2 #1 ] &gt; ].
</code></pre></div></div>

<p>A filter makes sure no special predicates remain:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mark_ditch_cf := elision_mtr &amp;
[ INPUT.RELS &lt; [ PRED "~_mark$" ] &gt; ].
</code></pre></div></div>

<h2 id="optional-rules">Optional Rules</h2>

<p>Optional rules cause the transfer to fork. This produces one branch
where the rule applied, and one where it didn’t.</p>

<p>They are conventionally written as rule-name-omtr and are defined as
follows:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>optional_mtr := mrs_transfer_rule &amp;
[ FLAGS.OPTIONAL + ].
</code></pre></div></div>

<p>The last rule in a set of transfer rules should be terminated. That is,
the last rule for a word’s translation should be an mtr, not an omtr. If
this isn’t done, then many spurious transfer outputs will be produced.</p>

<p>e.g.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hoeru_v_1-bark_v_1-omtr := arg1_v_omtr &amp;
[ INPUT.RELS &lt; [ PRED "_hoeru_v_1_rel" ] &gt;,
 OUTPUT.RELS &lt; [ PRED "_bark_v_1_rel" ] &gt; ].

hoeru_v_1-roar_v_1-mtr := arg1_v_mtr &amp;
[ INPUT.RELS &lt; [ PRED "_hoeru_v_1_rel" ] &gt;,
 OUTPUT.RELS &lt; [ PRED "_roar_v_1_rel" ] &gt; ].
</code></pre></div></div>

<h1 id="interlingua">Interlingua</h1>

<p>In MT, if you choose predicate names and definitions wisely, you can
transfer some things without the need for rules. To do this, you list
the predicates in <strong>*transfer-interlingua-predicates*</strong>.</p>

<ul>
  <li>In lkb/mt.lisp:</li>
</ul>

<!-- -->

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(defparameter *transfer-interlingua-predicates*
  '(lkb::named_rel lkb::proposition_m_rel))
</code></pre></div></div>

<h1 id="trouble-shooting">Trouble Shooting</h1>

<p>When you are transferring and then generating and get a message like
this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[10:59:24] translate(): read 1 MRS as generator input.
[10:59:24] translate(): processing MRS # 0 (4 EPs).
[10:59:24] translate(): error `Problem in create-liszt-fs-from-rels'.
</code></pre></div></div>

<p>The most likely cause is types in the MRS being read that aren’t in the
feature structure of the grammar used to generate. You need to transfer
them or delete them using the [wiki:<a href="LogonVpm">LogonVpm</a> VPM].</p>

<h2 id="to-ensure-something-is-a-noun">To ensure something is a noun</h2>

<p>Check that its in the scope of a quantifier.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CONTEXT.HCONS &lt; qeq &amp; [ LARG #h0 ] &gt;,
  INPUT.RELS &lt; [ PRED #pred, LBL #h0, ARG0 #x1 &amp; x &amp; [ NUM pl ] ],
               [ PRED mass_noun_mark, LBL #h0, ARG0 #x1 ] &gt;,
</code></pre></div></div>

<h2 id="limit-the-effort-in-transfer">Limit the effort in transfer</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(setf mt::*transfer-edge-limit* 1000)
</code></pre></div></div>

<h1 id="loading-the-rules">Loading the rules</h1>

<p>Rules are loaded using mt:read-transfer-rules. For example, from
<a href="/JaEn">JaEn</a>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(mt:read-transfer-rules 
 (list
  (lkb-pathname (parent-directory) "snug.mtr")
  (lkb-pathname (grandparent-directory) "erg.mtr")
  (lkb-pathname (parent-directory) "erg.mtr")
  (lkb-pathname (grandparent-directory) "finale.mtr"))
 "TL accomodation phase"
 :out :out :post :erg :filter nil :after "postprocess")
</code></pre></div></div>

<ul>
  <li>
    <p>:filter</p>

    <ul>
      <li>If at the start of transfer, for rule sets that were loaded with
`:filter t’, all input predicates are compared (as strings)
against the `dictionary’ of known INPUT predicates in that rule
set. that test, currently, does not take into account regular
expressions (though it probably should).</li>
    </ul>

    <p>:before</p>

    <ul>
      <li>This calls a function as a pre-process before the transfer takes
place.</li>
    </ul>

    <p>:after</p>

    <ul>
      <li>This calls a function as a post-process after the transfer takes
place.</li>
    </ul>

    <p>:out</p>

    <ul>
      <li><strong>no documentation here, move along</strong></li>
    </ul>

    <p>:post</p>

    <ul>
      <li><strong>no documentation here, move along</strong></li>
    </ul>
  </li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        


        


      </footer>

      

      
    </div>

    
  </article>

  
  
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form onsubmit="return googleCustomSearchExecute();" id="cse-search-box-form-id">
    <label class="sr-only" for="cse-search-input-box-id">
      Enter your search term...
    </label>
    <input type="search" id="cse-search-input-box-id" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results">
    <gcse:searchresults-only></gcse:searchresults-only>
  </div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/docsproto/concept/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Your Name. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/docsproto/concept/assets/js/main.min.js"></script>


<script>
  (function () {
    var cx = '7761c0bff1e224240';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();

  function googleCustomSearchExecute() {
    var input = document.getElementById('cse-search-input-box-id');
    var element = google.search.cse.element.getElement('searchresults-only0');
    if (input.value == '') {
      element.clearAllResults();
    } else {
      element.execute(input.value);
    }
    return false;
  }

  
</script>







  </body>
</html>
