<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>DELPH-IN Concepts</title>
<meta name="description" content="An amazing website.">


  <meta name="author" content="Your Name">
  


<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="DELPH-IN Concepts">
<meta property="og:title" content="DELPH-IN Concepts">
<meta property="og:url" content="http://blog.inductorsoftware.com/docsproto/concept/ItsdbTreebanking_ItsdbModeling/">


  <meta property="og:description" content="An amazing website.">











  

  


<link rel="canonical" href="http://blog.inductorsoftware.com/docsproto/concept/ItsdbTreebanking_ItsdbModeling/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Your Name",
      "url": "http://blog.inductorsoftware.com/docsproto/concept/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/docsproto/concept/feed.xml" type="application/atom+xml" rel="alternate" title="DELPH-IN Concepts Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/docsproto/concept/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--delphin_page wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/docsproto/concept/"><img src="/docsproto/concept/assets/images/Delph-In.png" alt="DELPH-IN Concepts"></a>
        
        <a class="site-title" href="/docsproto/concept/">
          DELPH-IN Concepts
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/home/Home">Home</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/concept/TreebankingTop">Concepts</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/tools/ToolsTop">Tools</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/erg/ErgTop">ERG</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/grammars/GrammarCatalogue">Grammars</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/matrix/MatrixTop">Matrix</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/summits/SummitTop">Summits</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">Treebanking</span>
        

        
        <ul>
          
            <li><a href="/docsproto/concept/TreebankingTop">Overview</a></li>
          
            <li><a href="/docsproto/concept/FftbTop">Full Forest Treebanker (FFTB)</a></li>
          
            <li><a href="/docsproto/concept/FftbWishlist">Full Forest Treebanker Wishlist</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking">[incr tsdb()] Treebanking</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking_ItsdbAnnotation">[incr tsdb()] Treebanking Annotation</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking_ItsdbUpdating">[incr tsdb()] Treebanking Updating</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking_ItsdbExporting">[incr tsdb()] Treebanking Exporting</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking_ItsdbModeling">[incr tsdb()] Treebanking Modeling</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking_ItsdbUpdating">[incr tsdb()] Treebanking Updating</a></li>
          
            <li><a href="/docsproto/concept/ItsdbCustomization">[incr tsdb()] Treebanking Customization</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking_ItsdbModeling">[incr tsdb()] Treebanking Modeling</a></li>
          
            <li><a href="/docsproto/concept/IndraTreebanking">Indra</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Formats</span>
        

        
        <ul>
          
            <li><a href="/docsproto/concept/DelphinRFCs">Delphin RFCs</a></li>
          
            <li><a href="/docsproto/concept/PredicateRfc">Predicate RFC</a></li>
          
            <li><a href="/docsproto/concept/MrsRFC">MRS Format RFC</a></li>
          
            <li><a href="/docsproto/concept/MrsIsomorphism">MRS Isomorphism</a></li>
          
            <li><a href="/docsproto/concept/EdsTop">EDS Format</a></li>
          
            <li><a href="/docsproto/concept/EdsConversion">EDS Conversion</a></li>
          
            <li><a href="/docsproto/concept/EdsGeneration">EDS Generation</a></li>
          
            <li><a href="/docsproto/concept/SemiRfc">SEM-I RFC</a></li>
          
            <li><a href="/docsproto/concept/TdlRFC">TDL RFC</a></li>
          
            <li><a href="/docsproto/concept/TsqlRfc">TSQL RFC</a></li>
          
            <li><a href="/docsproto/concept/GrammarVersionRfc">Grammar Version RFC</a></li>
          
            <li><a href="/docsproto/concept/GrammarConfigurationRfc">Grammar Configuration RFC</a></li>
          
            <li><a href="/docsproto/concept/TsdbSchemaRfc">TSDB Schema RFC</a></li>
          
            <li><a href="/docsproto/concept/MatrixChoicesRfc">Matrix Choices RFC</a></li>
          
            <li><a href="/docsproto/concept/RmrsTop">(R)MRS Overview</a></li>
          
            <li><a href="/docsproto/concept/RmrsWellformedness">(R)MRS Wellformedness</a></li>
          
            <li><a href="/docsproto/concept/RmrsPos">(R)MRS Predicate Naming</a></li>
          
            <li><a href="/docsproto/concept/RmrsSpan">(R)MRS Span</a></li>
          
            <li><a href="/docsproto/concept/RmrsDesign">(R)MRS Design</a></li>
          
            <li><a href="/docsproto/concept/RmrsParaphrasing">(R)MRS Paraphrasing</a></li>
          
            <li><a href="/docsproto/concept/RmrsModel">(R)MRS Model</a></li>
          
            <li><a href="/docsproto/concept/RmrsDistributional">(R)MRS Distributional</a></li>
          
            <li><a href="/docsproto/concept/RmrsSemi">(R)MRS Semi</a></li>
          
            <li><a href="/docsproto/concept/RmrsDmrs">(R)MRS Dmrs</a></li>
          
            <li><a href="/docsproto/concept/RmrsFaq">(R)MRS Faq</a></li>
          
            <li><a href="/docsproto/concept/RmrsDiscussions">(R)MRS Discussions</a></li>
          
            <li><a href="/docsproto/concept/TransferRules">Transfer Rules</a></li>
          
            <li><a href="/docsproto/concept/FormatSpecifications">Format Specifications</a></li>
          
            <li><a href="/docsproto/concept/ErgGml">Grammar Markup Language</a></li>
          
            <li><a href="/docsproto/concept/SmafTop">SMAF</a></li>
          
            <li><a href="/docsproto/concept/IconsSpecs">Icons Specs</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Discussions</span>
        

        
        <ul>
          
            <li><a href="/docsproto/concept/SaarlandSententialArgument">Saarland Sentential Argument</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Housekeeping</span>
        

        
        <ul>
          
            <li><a href="/docsproto/concept/ErgSemantics_Raw_Materials">Raw Materials</a></li>
          
            <li><a href="/docsproto/concept/ErgSemantics_Conventions">ERG Semantics Conventions</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
        <h1 id="page-status">Page Status</h1>

<p>This page presents user-supplied information, hence may be inaccurate in
some details, or not necessarily reflect use patterns anticipated by the
<a href="http://www.delph-in.net/itsdb">[incr tsdb()]</a> developers. This page
was initiated by <a href="https://blog.inductorsoftware.com/docsproto/tools/FrancisBond">FrancisBond</a>; please feel free to make
additions or corrections as you see fit. However, before revising this
page, one should be reasonably confident of the information given being
correct.</p>

<h1 id="overview">Overview</h1>

<p>Contents</p>

<ol>
  <li><a href="../ItsdbTreebanking_ItsdbModeling#Page_Status">Page Status</a></li>
  <li><a href="../ItsdbTreebanking_ItsdbModeling#Overview">Overview</a></li>
  <li><a href="../ItsdbTreebanking_ItsdbModeling#Training_a_Scoring_Model">Training a Scoring Model</a>
    <ol>
      <li><a href="../ItsdbTreebanking_ItsdbModeling#Scoring">Scoring</a></li>
      <li><a href="../ItsdbTreebanking_ItsdbModeling#Using_a_Scoring_Model_in_PET_and_the_LKB">Using a Scoring Model in PET and the
LKB</a></li>
      <li><a href="../ItsdbTreebanking_ItsdbModeling#Calculating_a_Baseline">Calculating a Baseline</a></li>
    </ol>
  </li>
  <li><a href="../ItsdbTreebanking_ItsdbModeling#Training_a_scoring_model_using_a_batch_script">Training a scoring model using a batch
script</a></li>
  <li><a href="../ItsdbTreebanking_ItsdbModeling#Using_TADM_directly_to_train_a_ranking_model">Using TADM directly to train a ranking
model</a>
    <ol>
      <li><a href="../ItsdbTreebanking_ItsdbModeling#Calling_tadm">Calling tadm</a></li>
    </ol>
  </li>
</ol>

<h1 id="training-a-scoring-model">Training a Scoring Model</h1>

<p>If you have treebanked a profile, and have Rob Malouf’s <a href="http://tadm.sourceforge.net/">TADM: Toolkit
for Advanced Discriminative Modeling</a>, in
particular the program tadm installed, then you can train a scoring
model which PET (<a href="https://blog.inductorsoftware.com/docsproto/tools/PetTop">PetTop</a>) can use. However, current <a href="http://www.delph-in.net/itsdb">[incr
tsdb()]</a> training and evaluation code
assumes a small number of patches to TADM that have yet to be
incorporated into the <a href="http://tadm.sourceforge.net/">SourceForge
repository</a>; feel free to contact
<a href="https://blog.inductorsoftware.com/docsproto/tools/StephanOepen">StephanOepen</a> for details. A pre-compiled binary is
available as part of the <a href="https://blog.inductorsoftware.com/docsproto/tools/LogonTop">LOGON tree</a>, and quite generally all
<a href="http://www.delph-in.net/itsdb">[incr tsdb()]</a> machine learning and
experimentation (MLE) functionality is best supported in the LOGON
environment. Look in the sub-directory lingo/redwoods/ for examples of
how to create virtual profiles and run extensive batch runs, e.g.
populating a feature cache, training models, and executing a grid search
for optimal feature selection and estimation parameters.</p>

<p>Select the treebanked profile (left-click), or profiles (click in the
radio buttons) and then select <em>Trees | Train</em> from the menus. It will
prompt you for the filename to put the scoring model in. The tradtion is
something like corpus-version.mem. You should have the grammar used for
treebanking loaded into the LKB (<a href="https://blog.inductorsoftware.com/docsproto/tools/LkbTop">LkbTop</a>). Training is normally
fairly fast.</p>

<h2 id="scoring">Scoring</h2>

<p>You can compare the ranking of a given profile with a treebanked gold
standard (assuming the same test-suite and grammar). The ranking can be
changed by changing the scoring model in the parser.</p>

<p>To compare: select the gold standard (middle click), then the profile to
be scored as the current database (left click); (make sure the current
version of the grammar is loaded into the LKB).</p>

<p>Set: <em>Trees | Switches | Implicit Ranks</em> and <em>Trees | Switches |
Result Equivalence</em>; and then go <em>Trees | Score</em>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ;; score results in .data. against ground truth in .gold.  operates in
 ;; several slightly distinct modes: (i) using the implicit parse ranking in
 ;; the order of `results' or (ii) using an explicit ranking from the `score'
 ;; relation an orthogonal dimension of variation is (a) scoring by result
 ;; identifier (e.g. within the same profile or against one that is comprised
 ;; of identical results) vs. (b) scoring by derivation equivalence (e.g.
 ;; when comparing best-first parser output against a gold standard).
</code></pre></div></div>

<p>In order to make the scoring faster, you should do a thinning normalize
on the gold profile for comparison first. This thins (implicitly) to
only those trees marked as good by the annotator, i.e. you thin out all
dis-preferred trees. To get a 5-best comparison, play with the
Scoring Beam value.</p>

<h2 id="using-a-scoring-model-in-pet-and-the-lkb">Using a Scoring Model in PET and the LKB</h2>

<h3 id="scoring-in-pet">Scoring in PET</h3>

<p>The scoring model is referenced in cheap’s grammar.set for PET:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>;;; scoring mechanism (fairly embryonic, for now)
sm := "hinoki.mem".
</code></pre></div></div>

<h3 id="scoring-in-the-lkb">Scoring in the LKB</h3>

<p>The scoring model is referenced in the script and globals.lsp for the
LKB:</p>

<p>script</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>;;; if you have [incr tsdb()], load a Maximum Entropy parse selection model
#+:tsdb
(tsdb::read-model (lkb-pathname (parent-directory) "hinoki.mem"))
</code></pre></div></div>

<p>globals.lsp</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>;;; use the parse selection model for selective unpacking
#+:tsdb
(setf *unpacking-scoring-hook* #'tsdb::mem-score-configuration)
</code></pre></div></div>

<h2 id="calculating-a-baseline">Calculating a Baseline</h2>

<p>You can calculate the baseline for a profile (the probability of a
random parse being correct) as follows:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(tsdb::baseline "profile-name")
(0.18341358 1.4064516 104.56272 1395)
</code></pre></div></div>

<p>The four numbers are the baseline itself, the average number of selected
trees, ??? and the number of items considered. The default condition is
readings &gt; 1 &amp;&amp; t-active &gt;= 1, that is, all ambiguous parses that
have been reduced. You can add extra conditions, for example to only
consider items where the results are resolved to a single parse:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(tsdb::baseline "profile-name" :condition "t-active = 1")
(0.20147601 1.0 64.88867 1015)
</code></pre></div></div>

<h1 id="training-a-scoring-model-using-a-batch-script">Training a scoring model using a batch script</h1>

<p>Use the redwood script
<a href="http://svn.emmtee.net/trunk/lingo/redwoods/train.lisp">train.lisp</a>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./load train.lisp
</code></pre></div></div>

<p>This should work if you have the treebanks and skeletons in the right
places. It first caches the values (fc.dbd) and then trains the models.
You must have <strong>tadm</strong> to do the actual training.</p>

<h1 id="using-tadm-directly-to-train-a-ranking-model">Using TADM directly to train a ranking model</h1>

<p>To create a ranker you just need to specify the number of options for
each event and indicate the number of observations for each option
(often 0 or 1 when looking at a single, uncondensed event). Say you were
doing parse reranking, and your first sentence has 2 parses and the 1st
is the correct one, and the second sentence has 5 parses and the 4th one
is the correct one. Then your event file would like like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2
1 &lt;features of the first parse&gt;
0 &lt;features of the second parse&gt;
5
0 &lt;features of the first parse&gt;
0 &lt;features of the second parse&gt;
0 &lt;features of the third parse&gt;
1 &lt;features of the fourth parse&gt;
0 &lt;features of the fifth parse&gt;
</code></pre></div></div>

<p>The difference with a classifier is that different events can have
different numbers of outcomes and the features won’t include the class
label as part of their definition. The reason TADM can be used for
ranking is precisely because it doesn’t pack in the class label into the
features automatically.</p>

<p>From Jason Baldridge
<a href="http://sourceforge.net/projects/tadm/forums/forum/473054/topic/1992369">http://sourceforge.net/projects/tadm/forums/forum/473054/topic/1992369</a></p>

<p>Note that: &lt;features of the nth parse&gt; should be an integer giving
how many pairs of parses there are, and then pairs of integers showing
feature frequency. e.g.,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3 0 1 1 3 2 1 
</code></pre></div></div>

<h2 id="calling-tadm">Calling tadm</h2>

<p>To train a model:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tadm -events_in trains_df.eve.gz -params_out para_df-smooth.par -monitor -fatol 1e-32 -frtol 1e-7 -variances variances -malloc_log
</code></pre></div></div>

<p>To evaluate a model:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>evaluate para_df-smooth.par test_df.eve.gz
</code></pre></div></div>

        
      </section>

      <footer class="page__meta">
        
        


        


      </footer>

      

      
    </div>

    
  </article>

  
  
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form onsubmit="return googleCustomSearchExecute();" id="cse-search-box-form-id">
    <label class="sr-only" for="cse-search-input-box-id">
      Enter your search term...
    </label>
    <input type="search" id="cse-search-input-box-id" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results">
    <gcse:searchresults-only></gcse:searchresults-only>
  </div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/docsproto/concept/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Your Name. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/docsproto/concept/assets/js/main.min.js"></script>


<script>
  (function () {
    var cx = '7761c0bff1e224240';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();

  function googleCustomSearchExecute() {
    var input = document.getElementById('cse-search-input-box-id');
    var element = google.search.cse.element.getElement('searchresults-only0');
    if (input.value == '') {
      element.clearAllResults();
    } else {
      element.execute(input.value);
    }
    return false;
  }

  
</script>







  </body>
</html>
