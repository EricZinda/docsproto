<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>DELPH-IN Concepts</title>
<meta name="description" content="An amazing website.">


  <meta name="author" content="Your Name">
  


<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="DELPH-IN Concepts">
<meta property="og:title" content="DELPH-IN Concepts">
<meta property="og:url" content="http://blog.inductorsoftware.com/docsproto/concept/TsqlRfc/">


  <meta property="og:description" content="An amazing website.">











  

  


<link rel="canonical" href="http://blog.inductorsoftware.com/docsproto/concept/TsqlRfc/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Your Name",
      "url": "http://blog.inductorsoftware.com/docsproto/concept/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/docsproto/concept/feed.xml" type="application/atom+xml" rel="alternate" title="DELPH-IN Concepts Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/docsproto/concept/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--delphin_page wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/docsproto/concept/"><img src="/docsproto/concept/assets/images/Delph-In.png" alt="DELPH-IN Concepts"></a>
        
        <a class="site-title" href="/docsproto/concept/">
          DELPH-IN Concepts
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/home/Home">Home</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/concept/ErgSemantics">Concepts</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/tools/ToolsTop">Tools</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/erg/ErgTop">ERG</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/grammars/GrammarCatalogue">Grammars</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/matrix/MatrixTop">Matrix</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/summits/SummitTop">Summits</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">Treebanking</span>
        

        
        <ul>
          
            <li><a href="/docsproto/concept/TreebankingTop">Overview</a></li>
          
            <li><a href="/docsproto/concept/FftbTop">Full Forest Treebanker (FFTB)</a></li>
          
            <li><a href="/docsproto/concept/FftbWishlist">Full Forest Treebanker Wishlist</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking">[incr tsdb()] Treebanking</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking_ItsdbAnnotation">[incr tsdb()] Treebanking Annotation</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking_ItsdbUpdating">[incr tsdb()] Treebanking Updating</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking_ItsdbExporting">[incr tsdb()] Treebanking Exporting</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking_ItsdbModeling">[incr tsdb()] Treebanking Modeling</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking_ItsdbUpdating">[incr tsdb()] Treebanking Updating</a></li>
          
            <li><a href="/docsproto/concept/ItsdbCustomization">[incr tsdb()] Treebanking Customization</a></li>
          
            <li><a href="/docsproto/concept/ItsdbTreebanking_ItsdbModeling">[incr tsdb()] Treebanking Modeling</a></li>
          
            <li><a href="/docsproto/concept/IndraTreebanking">Indra</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Formats</span>
        

        
        <ul>
          
            <li><a href="/docsproto/concept/DelphinRFCs">Delphin RFCs</a></li>
          
            <li><a href="/docsproto/concept/PredicateRfc">Predicate RFC</a></li>
          
            <li><a href="/docsproto/concept/MrsRFC">MRS Format RFC</a></li>
          
            <li><a href="/docsproto/concept/MrsIsomorphism">MRS Isomorphism</a></li>
          
            <li><a href="/docsproto/concept/EdsTop">EDS Format</a></li>
          
            <li><a href="/docsproto/concept/EdsConversion">EDS Conversion</a></li>
          
            <li><a href="/docsproto/concept/EdsGeneration">EDS Generation</a></li>
          
            <li><a href="/docsproto/concept/SemiRfc">SEM-I RFC</a></li>
          
            <li><a href="/docsproto/concept/TdlRFC">TDL RFC</a></li>
          
            <li><a href="/docsproto/concept/TsqlRfc">TSQL RFC</a></li>
          
            <li><a href="/docsproto/concept/GrammarVersionRfc">Grammar Version RFC</a></li>
          
            <li><a href="/docsproto/concept/GrammarConfigurationRfc">Grammar Configuration RFC</a></li>
          
            <li><a href="/docsproto/concept/TsdbSchemaRfc">TSDB Schema RFC</a></li>
          
            <li><a href="/docsproto/concept/MatrixChoicesRfc">Matrix Choices RFC</a></li>
          
            <li><a href="/docsproto/concept/RmrsTop">(R)MRS Overview</a></li>
          
            <li><a href="/docsproto/concept/RmrsWellformedness">(R)MRS Wellformedness</a></li>
          
            <li><a href="/docsproto/concept/RmrsPos">(R)MRS Predicate Naming</a></li>
          
            <li><a href="/docsproto/concept/RmrsSpan">(R)MRS Span</a></li>
          
            <li><a href="/docsproto/concept/RmrsDesign">(R)MRS Design</a></li>
          
            <li><a href="/docsproto/concept/RmrsParaphrasing">(R)MRS Paraphrasing</a></li>
          
            <li><a href="/docsproto/concept/RmrsModel">(R)MRS Model</a></li>
          
            <li><a href="/docsproto/concept/RmrsDistributional">(R)MRS Distributional</a></li>
          
            <li><a href="/docsproto/concept/RmrsSemi">(R)MRS Semi</a></li>
          
            <li><a href="/docsproto/concept/RmrsDmrs">(R)MRS Dmrs</a></li>
          
            <li><a href="/docsproto/concept/RmrsFaq">(R)MRS Faq</a></li>
          
            <li><a href="/docsproto/concept/RmrsDiscussions">(R)MRS Discussions</a></li>
          
            <li><a href="/docsproto/concept/TransferRules">Transfer Rules</a></li>
          
            <li><a href="/docsproto/concept/FormatSpecifications">Format Specifications</a></li>
          
            <li><a href="/docsproto/concept/ErgGml">Grammar Markup Language</a></li>
          
            <li><a href="/docsproto/concept/SmafTop">SMAF</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Projects</span>
        

        
        <ul>
          
            <li><a href="/docsproto/concept/RedwoodsTop">Redwoods</a></li>
          
            <li><a href="/docsproto/concept/DeepBank">DeepBank</a></li>
          
            <li><a href="/docsproto/concept/DeepBank_OneZero">DeepBank 1.0</a></li>
          
            <li><a href="/docsproto/concept/ErgSemantics_Discovery">Semantics Discovery</a></li>
          
            <li><a href="/docsproto/concept/WikiWoods">WikiWoods</a></li>
          
            <li><a href="/docsproto/concept/SemCor">SC corpus</a></li>
          
            <li><a href="/docsproto/concept/WeScience">We Science</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Discussions</span>
        

        
        <ul>
          
            <li><a href="/docsproto/concept/SaarlandSententialArgument">Saarland Sentential Argument</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Housekeeping</span>
        

        
        <ul>
          
            <li><a href="/docsproto/concept/ErgSemantics_Raw_Materials">Raw Materials</a></li>
          
            <li><a href="/docsproto/concept/ErgSemantics_Conventions">ERG Semantics Conventions</a></li>
          
            <li><a href="/docsproto/concept/IconsSpecs">Icons Specs</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
        <h1 id="tsql-test-suite-query-language">TSQL: Test Suite Query Language</h1>

<p>TSQL is a query language for selecting data from <a href="http://www.delph-in.net/itsdb">[incr
tsdb()]</a> test suites partially described
in <a href="http://www.delph-in.net/tsnlp/ftp/manual/volume2.ps.gz">TSNLP User Manual (Volume
2)</a>.</p>

<p>TSQL is generally used for selecting rows or columns of data from test
suites themselves, although it also has faculties for inspecting or
setting <a href="http://www.delph-in.net/itsdb">[incr tsdb()]</a> variables and
for inserting data into test suites. Some examples of select queries
include:</p>

<p>Find the item IDs and grammatical sentences that didn’t parse:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select i-id i-input where i-wf = 1 and readings = 0
</code></pre></div></div>

<p>Pair input sentences with their MRS outputs:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select i-input mrs
</code></pre></div></div>

<p>Find sentences with fewer than 10 words:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select i-input where i-length &lt; 10
</code></pre></div></div>

<h2 id="tsql-syntax">TSQL Syntax</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   1 Query        := ( Info | Set | Retrieve | Insert ) ( '.' | $ )
   2 Info         := 'info' ( 'all' | 'relations' | Relation | TsdbConstant | TsdbVariable )
   3 Set          := 'set' TsdbVariable ( Integer | String | ':on' | ':off' )
   4 Retrieve     := ( 'retrieve' | 'select' ) SelectBody
   5 SelectBody   := ( Attribute+ | '*' )
   6                 [ 'from' Relation+ ]
   7                 [ 'where' Disjunction ]
   8                 [ 'report' FormatString ]
   9 Insert       := 'insert' 'into' Relation [ Attribute+ ]
  10                          'values' ( Integer | String | DateTime )+
  11 
  12 TsdbConstant := 'home'
  13               | 'tsdb_home'
  14               | 'relations-file'
  15               | 'tsdb_relations_file'
  16               | 'data-path'
  17               | 'tsdb_data_path'
  18 TsdbVariable := 'result-path'
  19               | 'tsdb_result_path'
  20               | 'result-prefix'
  21               | 'tsdb_result_prefix'
  22               | 'max-results'
  23               | 'tsdb_max_results'
  24               | 'uniquely-project'
  25               | 'tsdb_uniquely_project'
  26 
  27 Relation     := Identifier
  28 Attribute    := Identifier
  29 
  30 Disjunction  := Conjunction ( '|' | '||' | 'or'  Conjunction )*
  31 Conjunction  := Condition ( '&amp;' | '&amp;&amp;' | 'and' Condition)*
  32 Condition    := Attribute ( '=' | '==' | '!=' | '~' | '!~' ) String
  33               | Attribute ( '=' | '==' | '!=' | '&lt;' | '&gt;' | '&lt;=' | '&gt;=' ) ( Integer | DateTime )
  34               | ( '!' | 'not' ) Condition
  35               | '(' Disjunction ')'
  36 
  37 FormatString := String
  38 
  39 Integer      := /[+-]?[0-9]+/
  40 Digit        := /[0-9]+]
  41 
  42 String       := /"([^"\\]|\\.)*"/"
  43               | /'([^'\\]|\\.)*'/
  44 
  45 DateTime     := Date [ ( Time | '(' Time ')' ) ]
  46               | [ ':' ] 'today'
  47               | [ ':' ] 'now'
  48 Date         := FullYear Month [ '-' Day ]
  49               | [ Day '-' ] Month '-' Year
  50 FullYear     := Digit Digit Digit Digit
  51 Year         := [ Digit Digit ] Digit Digit
  52 Month        := [ Digit ] Digit
  53               | MonthName
  54 MonthName    := 'jan' | 'feb' | 'mar' | 'apr' | 'may' | 'jun'
  55               | 'jul' | 'aug' | 'sep' | 'oct' | 'nov' | 'dec'
  56 Day          := [ Digit ] Digit
  57 Time         := Digit Digit ':' Digit Digit [ ':' Digit Digit ]
  58 
  59 Identifier   := Character ( Character | Digit | '-' | '_' )+
  60 Character    := /[a-zA-Z]+/
</code></pre></div></div>

<h3 id="notes-on-the-syntax">Notes on the Syntax</h3>

<p>Different publications and implementations have some differences in the
syntax. Some of those differences are listed here, excepting obvious
bugs in the BNFs, as well as some general notes about the query
language.</p>

<h4 id="case-sensitivity">Case Sensitivity</h4>

<p>Some literals in the syntax (e.g., select, info, or from) are
case-insensitive, but relation (table) names, attributes (column names),
and some other literals (e.g., all, relations, tsdb_home, etc.) are
case-sensitive. The names of months in dates are case-insensitive.</p>

<h4 id="date-formats">Date Formats</h4>

<p>The TSNLP version of TSQL does not define or accept YYYY-MM-DD dates,
nor does it define MonthName forms (although it appears to accept them).
Note that MonthName may be locale-dependent.</p>

<h4 id="report-formatting">Report Formatting</h4>

<p>FormatString does not appear to be defined or even described anywhere in
prior literature. From my experiments, it seems to be a <a href="https://en.wikipedia.org/wiki/Printf_format_string">printf
string</a> with format
specifiers (%s, %d, or %i) used to insert column values (though it does
not appear to matter which is used; e.g., %d could be used for a :string
value, etc.). For instance, a query like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select i-id i-input i-date
</code></pre></div></div>

<p>…could use up to three format specifiers (any more <em>may</em> trigger an
error), such as:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>report "ID=%s,Input=%s,Date=%s"
</code></pre></div></div>

<p>If fewer than three format specifiers are used, the remaining data is
output in <a href="http://www.delph-in.net/itsdb">[incr tsdb()]</a> table format.</p>

<h4 id="order-of-operations-in-conditions">Order of Operations in Conditions</h4>

<p>The TSNLP definition of TSQL syntax does not specify an order of
operations for boolean operations on conditions. In the BNF above, I
specifically scoped disjunctions over conjunctions, which seems to
follow the behaviour of LOGON’s tsdb -query utility. Thus, the following
query would match items with i-id = 10 whether or not its i-input
matched [Dd]og:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select i-input where i-id = 10 or i-id = 20 and i-input ~ "[Dd]og"
</code></pre></div></div>

<p>Parentheses can be used to override this order:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select i-input where (i-id = 10 or i-id = 20) and i-input ~ "[Dd]og"
</code></pre></div></div>

<h2 id="implementation-differences">Implementation Differences</h2>

<p>The <a href="https://github.com/delph-in/pydelphin/">PyDelphin</a> implementation
of TSQL as of 2018-10-05 only includes select queries without report
clauses. It differs from the LOGON tsdb -query utility in some ways:</p>

<ul>
  <li>select * requires a from clause</li>
  <li>select * from item result does not also include columns from parse
(the “intervening” table joined in order to join item and result)</li>
  <li>select * from item where readings &gt; 0 does not include columns
from parse (where readings is defined)</li>
</ul>

<p>PyDelphin also adds a couple features:</p>

<ul>
  <li>Attributes in the projection (column list) and where clause of the
query may optionally use qualified names to specify both the table
and column (e.g., result.parse-id)</li>
  <li>
    <p>Multiple where clauses may be used which act as a conjunction scoped
over disjunctions. Thus, the following is the same as the
parenthesized form in the “Order of Operations in Conditions”
section above.</p>

    <ul>
      <li>select i-input where i-id = 10 or i-id = 20 where i-input ~ “[Dd]og”</li>
    </ul>
  </li>
</ul>

<p>Multiple where clauses are useful for assembling queries. A user may add
an additional global constraint by appending a new where clause without
having to worry about altering the order of operations of existing
conditions.</p>

<h2 id="feature-requests">Feature Requests</h2>

<p>1. adding support for left/right/inner joins. See
<a href="https://github.com/delph-in/pydelphin/issues/321">https://github.com/delph-in/pydelphin/issues/321</a>.</p>

        
      </section>

      <footer class="page__meta">
        
        


        


      </footer>

      

      
    </div>

    
  </article>

  
  
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form onsubmit="return googleCustomSearchExecute();" id="cse-search-box-form-id">
    <label class="sr-only" for="cse-search-input-box-id">
      Enter your search term...
    </label>
    <input type="search" id="cse-search-input-box-id" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results">
    <gcse:searchresults-only></gcse:searchresults-only>
  </div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/docsproto/concept/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Your Name. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/docsproto/concept/assets/js/main.min.js"></script>


<script>
  (function () {
    var cx = '7761c0bff1e224240';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();

  function googleCustomSearchExecute() {
    var input = document.getElementById('cse-search-input-box-id');
    var element = google.search.cse.element.getElement('searchresults-only0');
    if (input.value == '') {
      element.clearAllResults();
    } else {
      element.execute(input.value);
    }
    return false;
  }

  
</script>







  </body>
</html>
