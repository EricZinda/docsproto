<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>DELPH-IN Tools</title>
<meta name="description" content="An amazing website.">


  <meta name="author" content="Your Name">
  


<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="DELPH-IN Tools">
<meta property="og:title" content="DELPH-IN Tools">
<meta property="og:url" content="http://blog.inductorsoftware.com/docsproto/tools/ItsdbDerivations/">


  <meta property="og:description" content="An amazing website.">











  

  


<link rel="canonical" href="http://blog.inductorsoftware.com/docsproto/tools/ItsdbDerivations/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Your Name",
      "url": "http://blog.inductorsoftware.com/docsproto/tools/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/docsproto/tools/feed.xml" type="application/atom+xml" rel="alternate" title="DELPH-IN Tools Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/docsproto/tools/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--delphin_page wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/docsproto/tools/"><img src="/docsproto/tools/assets/images/Delph-In.png" alt="DELPH-IN Tools"></a>
        
        <a class="site-title" href="/docsproto/tools/">
          DELPH-IN Tools
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/concept">Concepts</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/docsproto/tools">Tools</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">Tools</span>
        

        
        <ul>
          
            <li><a href="/docsproto/tools/ToolsTop">Overview</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Grammar Environments</span>
        

        
        <ul>
          
            <li><a href="/docsproto/tools/AgreeTop">Agree</a></li>
          
            <li><a href="/docsproto/tools/MatrixGettingStarted">Grammar Matrix Getting Started</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Grammar Tools</span>
        

        
        <ul>
          
            <li><a href="/docsproto/tools/EgadTop">Erroneous Generation Analysis and Detection</a></li>
          
            <li><a href="/docsproto/tools/GDeltaTop">gDelta</a></li>
          
            <li><a href="/docsproto/tools/SpringCleaningTop">Grammar Spring Cleaning</a></li>
          
            <li><a href="/docsproto/tools/LkbLtdb">Linguistic Type Database</a></li>
          
            <li><a href="/docsproto/tools/ClimbShortClimb">SHORT-CLIMB</a></li>
          
            <li><a href="/docsproto/tools/TypediffTop">Typediff</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Parsing and Generation</span>
        

        
        <ul>
          
            <li><a href="/docsproto/tools/AceTop">Ace</a></li>
          
            <li><a href="/docsproto/tools/DelphinTools">Delphin Tools</a></li>
          
            <li><a href="/docsproto/tools/VistaExtractionTop">VistaExtractionTop</a></li>
          
            <li><a href="/docsproto/tools/ReppTop">Regular Expression Pre-Processor</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Misc</span>
        

        
        <ul>
          
            <li><a href="/docsproto/tools/HeartofgoldTop">Heart of Gold</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">LKB</span>
        

        
        <ul>
          
            <li><a href="/docsproto/tools/LkbTop">Overview</a></li>
          
            <li><a href="/docsproto/tools/LkbInstallation">Installation</a></li>
          
            <li><a href="/docsproto/tools/LkbFos">Fully Open Source Version</a></li>
          
            <li><a href="/docsproto/tools/LkbMacintosh">Macintosh Version</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">PET</span>
        

        
        <ul>
          
            <li><a href="/docsproto/tools/PetTop">Pet</a></li>
          
            <li><a href="/docsproto/tools/PetInput">PetInput</a></li>
          
            <li><a href="/docsproto/tools/ItsdbDerivations">[incr tsdb()] Derivations</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Logon</span>
        

        
        <ul>
          
            <li><a href="/docsproto/tools/LogonTop">Overview</a></li>
          
            <li><a href="/docsproto/tools/LogonPet">Pet</a></li>
          
            <li><a href="/docsproto/tools/LogonAnswer">ACE</a></li>
          
            <li><a href="/docsproto/tools/LogonExtras">Extras</a></li>
          
            <li><a href="/docsproto/tools/LogonInstallation">Installation</a></li>
          
            <li><a href="/docsproto/tools/LogonReports">Reports</a></li>
          
            <li><a href="/docsproto/tools/LogonProcessing">Processing</a></li>
          
            <li><a href="/docsproto/tools/LogonProcessing_BatchParsing">Batch Parsing</a></li>
          
            <li><a href="/docsproto/tools/LogonModeling">Modeling</a></li>
          
            <li><a href="/docsproto/tools/LogonOnline">Online</a></li>
          
            <li><a href="/docsproto/tools/LogonTransfer">Transfer</a></li>
          
            <li><a href="/docsproto/tools/LogonIdiosyncrasies">Idiosyncrasies</a></li>
          
            <li><a href="/docsproto/tools/LogonWishlist">Wishlist</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
        <h1 id="overview">Overview</h1>

<p>The <a href="http://www.delph-in.net/itsdb">[incr tsdb()]</a> environment records
information about <em>derivations</em> (the ‘recipes’ of linguistic analyses)
in its database. Combined with the grammar originally used to derive
each analysis, the derivation structure needs to provide complete
information for re-building the analysis. In other words, the derivation
can serve as an oracle to a process that one can conceptualize as
deterministic parsing: the derivation records exactly which steps the
original <a href="http://www.delph-in.net/itsdb">[incr tsdb()]</a> client
processor had taken in producing its analysis. Deterministically
re-building (or re-playing) an analysis, thus, will give rise to the
exact same structure as was associated with the original result.</p>

<p>In principle, the <a href="http://www.delph-in.net/itsdb">[incr tsdb()]</a>
derivation format is applicable to any kind of processing client (be it
the LKB, PET, TRALE, XLE or ACE) and all types of processing (e.g.
parsing, generation, transfer, or translation). However, in practice
only parsing and generation derivations produced by
either the LKB, PET, or ACE are fully supported yet.</p>

<p>This page documents the format used internally by <a href="http://www.delph-in.net/itsdb">[incr
tsdb()]</a> to record derivations (this
specification is sometimes half-jokingly referred to as <em>Unified
Derivation Format</em> or UDF). This page was predominantly authored by
<a href="https://github.com/oepen">Stephan Oepen</a>, who jointly with Ulrich Callmeier developed the original UDF 1.0
specification. Please do not make substantial changes unless you (a) are
reasonably sure of the technical correctness of your revisions and (b)
believe strongly that your changes are compatible with the general
design and recommended use patterns for <a href="http://www.delph-in.net/itsdb">[incr tsdb()]</a>, and of course with the goals
of this page.</p>

<h1 id="an-example">An Example</h1>

<p>Following is an example derivation taken from the <a href="WeScience">WeScience</a>
treebank. This derivation is the result of parsing item WS01/10021300:
<em>Many terms are ambiguous.</em></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  (root_strict
   (515 subjh 5.63927 0 4
    (511 bare_np 0.986543 0 2
     (510 adjn -0.115529 0 2
      (44 many_a1 -0.657932 0 1
       ("many" 41
        "token [ +FORM \"many\" +FROM \"0\" +TO \"3\" ... ]"))
      (509 noptcomp 0.277526 1 2
       (508 plur_noun_orule 0.274656 1 2
        (54 term_n1 0 1 2
         ("terms" 30
          "token [ +FORM \"terms\" +FROM \"5\" +TO \"9\" ... ]"))))))
    (514 hcomp 3.121 2 4
     (72 be_c_are -0.558293 2 3
      ("are" 32
       "token [ +FORM \"are\" +FROM \"11\" +TO \"13\" ... ]"))
     (513 hoptcomp 1.8935 3 4
      (512 punct_period_orule 0 3 4
       (80 generic_adj 0 3 4
        ("ambiguous." 40
         "token [ +FORM \"ambiguous.\" +FROM \"15\" +TO \"24\" ... ]")))))))
</code></pre></div></div>

<p>The derivation is a tree whose core is comprised of identifiers for
<em>grammar entities</em>, i.e. the names of grammar rules and lexical entries.
In our example, <em>subjh</em>, <em>bare_np</em>, <em>adjn</em>, <em>noptcomp</em>, and so forth
name grammar rules of the ERG. Conversely, <em>many_a1</em>, <em>term_n1</em>,
<em>be_c_are</em>, and <em>generic_adj</em> are the identifiers of the lexical
entries used in this derivation.</p>

<p>All internal nodes but the topmost one name grammar rules, and all
preterminal nodes name lexical entries. The topmost (or root) node is
special, in that it identifies the start symbol (‘root’ feature
structure) used to license the derivation. Also, this element of the
derivation tree is optional, i.e. may or may not be present. Finally,
the terminal (aka leaf) nodes of the tree correspond to the actual input
to the parser, i.e. a sequence of input tokens. Note that UDF allows
some format variation in recording leaf nodes, as token feature
structures will only be available in some configuration, viz. when
parsing in PET, using the so-called chart mapping machinery (see the
<a href="../PetInput">PetInput</a> page for background). Thus, a legitimate variation
of the example above would be representing terminal nodes by just the
token string, e.g.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  (...
   (54 term_n1 0 1 2
    ("terms")))
</code></pre></div></div>

<p>Further note that the example above abbreviates some of the information
in the actual token feature structures.</p>

<h1 id="unified-derivation-format--more-formally">Unified Derivation Format — More Formally</h1>

<p>All regular nodes of derivation trees provide five fields of
information, in the format</p>

<p>(<em>id</em> <em>entity</em> <em>score</em> <em>start</em> <em>end</em> <em>daughter</em><sup>+</sup>)</p>

<p>The <em>id</em> is an integer uniquely identifying the corresponding edge (i.e.
tree node or other corresponding object, in non-chart universes), When
analyzing an ambiguous input, where a sub-structure may be shared across
distinct analyses, it is expected that such shared nodes (and only such
nodes, i.e. sub-trees occuring in multiple complete analyses) will have
the same <em>id</em> across derivations. This uniqueness assumption is only
made relative to one input, of course.</p>

<p>The <em>entity</em> field is the most important part of the information
recorded in the derivation, naming the grammar entity that gave rise to
this node.</p>

<p>The <em>score</em> field is a floating point number, recording the
probabilistic score (or heuristic weight, or whatever) of the node,
where applicable. In parsing with PET or the LKB, for example, the
<em>score</em> field will contain the unnormalized MaxEnt score assigned to the
underlying chart edge, i.e. the sum of all weights λ<sub>i</sub> for
features <em>f</em><sub>i</sub> present in the edge, including its daughters.</p>

<p>Finally, the <em>start</em> and <em>end</em> fields record the sub-string
corresponding to each node, measured in inter-word positions, for
example chart vertices. Strictly speaking, this information is
redundant, as it could be derived from the nesting of nodes, relative to
the sequence of preterminals.</p>

<p>To record the exact ‘recipe’ used in deriving an
analysis, all but the <em>entity</em> fields are optional. However, the UDF
syntax requires all five fields to be instantiated on each (non-top and
non-leaf) node. By convention, numeric fields (especially the <em>score</em>)
can be underspecified under a value of ‘-1’.</p>

<h1 id="export-format-for-derivation">Export Format for Derivation</h1>

<p>There is an extended variant of UDF, dubbed UDX, that decorates elements
of derivations with additional information, specifically redundant
information that can in principle be obtained from looking up <em>entity</em>
identifiers in the underlying grammar. Inlining such redundant
information can simplify data exchange, for example when exporting
<a href="http://www.delph-in.net/itsdb">[incr tsdb()]</a> profiles into a textual
interchange format, for downstream processing with greater independence
of the native DELPH-IN toolchain.</p>

<p>As of mid-2013, the two extra elements in UDX are</p>

<ul>
  <li>indicating head daughters (according to the head percolation table
of the original grammar) in all branching syntactic constructions;
the <em>entity</em> identifier of a head daughter is prefixed with a caret
symbol (<code class="language-plaintext highlighter-rouge">^</code>).</li>
  <li>annotating preterminal nodes (i.e. lexical entries) with their
lexical type; here, the <em>entity</em> identifier will be suffixed with a
type name, separated from the <em>entity</em> with an at sign (<code class="language-plaintext highlighter-rouge">@</code>).</li>
</ul>

<p>In UDX, and using current identifiers from the 1212 release of the ERG,
our running example will look like the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  (ROOT_STRICT
   (415 SB-HD_MC_C 5.11757 0 4
    (412 HDN_BNP_C 1.10304 0 2
     (411 AJ-HDN_NORM_C 0.356599 0 2
      (58 many_a1@aj_-_i-many_le -0.399859 0 1
       ("many" 54
        "token [ +FORM \"many\" +FROM \"0\" +TO \"4\" ... ] ]"))
     (410 ^HDN_OPTCMP_C -0.986635 1 2
       (409 N_PL_OLR -0.793365 1 2
        (73 term_n1@n_pp_c-of_le -1.23404 1 2
         ("terms" 45
          "token [ +FORM "terms" +FROM \"5\" +TO \"10\" ... ] ]"))))))
    (414 ^HD-CMP_U_C 2.90046 2 4
     (97 be_c_are@v_prd_are_le 2.53757 2 3
      ("are" 47
       "token [ +FORM "are" +FROM \"11\" +TO \"14\" ... ] ]"))
     (413 W_PERIOD_PLR -0.394208 3 4
      (106 generic_adj@aj_-_i-unk_le 0 3 4
       ("ambiguous." 53
        "token [ +FORM \"ambiguous.\" +FROM \"15\" +TO \"25\" ... ]"))))))
</code></pre></div></div>

<h1 id="known-bugs">Known Bugs</h1>

<p>As of early 2009, PET is known to sometimes ‘forget’ to include the root
node in derivations returned to <a href="http://www.delph-in.net/itsdb">[incr
tsdb()]</a>; as the top-most node (with
only one field, which is how it is recognized) is optional in the syntax
specification, this is only a problem of missing information. However,
PET is also known to sometimes output root nodes (one field, naming a
root feature structure, not a grammar rule or lexical entry) as internal
nodes in derivation trees, which violates the UDF syntax. <a href="http://www.delph-in.net/itsdb">[incr
tsdb()]</a> works around these divergences
silently, i.e. the derivation reader will ignore such superfluous,
internal nodes with only one field of information. The current theory is
that both bugs are related to the same chart edge being used both as the
root of one analysis, and simultaneously as an internal node in another
derivation. This problem was resolved in early 2012.</p>

<h1 id="pending">Pending</h1>

<ul>
  <li>comments about ACE related to UDF and UDX.</li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        


        


      </footer>

      

      
    </div>

    
  </article>

  
  
</div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/docsproto/tools/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Your Name. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/docsproto/tools/assets/js/main.min.js"></script>










  </body>
</html>
